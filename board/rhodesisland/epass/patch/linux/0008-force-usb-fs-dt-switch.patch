--- a/drivers/usb/musb/sunxi.c
+++ b/drivers/usb/musb/sunxi.c
@@ -84,6 +84,8 @@
 	struct work_struct	work;
 	struct extcon_dev	*extcon;
 	struct notifier_block	host_nb;
+	bool hs_enabled;
+
 };
 
 /* phy_power_on / off may sleep, so we use a workqueue  */
@@ -817,6 +819,9 @@
 		goto err_unregister_usb_phy;
 	}
 
+	glue->hs_enabled = of_property_read_bool(np, "srgn,usb-hs-enabled");
+	printk("srgn,usb-hs-enabled: %d\n", glue->hs_enabled);
+
 	return 0;
 
 err_unregister_usb_phy:

--- a/drivers/usb/musb/musb_core.c
+++ b/drivers/usb/musb/musb_core.c
@@ -1043,6 +1043,25 @@
 
 }
 
+#ifdef CONFIG_USB_MUSB_SUNXI
+struct sunxi_glue {
+	struct device		*dev;
+	struct musb		*musb;
+	struct platform_device	*musb_pdev;
+	struct clk		*clk;
+	struct reset_control	*rst;
+	struct phy		*phy;
+	struct platform_device	*usb_phy;
+	struct usb_phy		*xceiv;
+	enum phy_mode		phy_mode;
+	unsigned long		flags;
+	struct work_struct	work;
+	struct extcon_dev	*extcon;
+	struct notifier_block	host_nb;
+	bool hs_enabled;
+};
+#endif //CONFIG_USB_MUSB_SUNXI
+
 /*
  * Program the HDRC to start (enable interrupts, dma, etc.).
  */
@@ -1052,21 +1071,43 @@
 	u8              devctl = musb_readb(regs, MUSB_DEVCTL);
 	u8		power;
 
+#ifdef CONFIG_USB_MUSB_SUNXI
+	struct sunxi_glue *glue = dev_get_drvdata(musb->controller->parent);
+#endif //CONFIG_USB_MUSB_SUNXI
+
 	musb_dbg(musb, "<== devctl %02x", devctl);
 
 	musb_enable_interrupts(musb);
 	musb_writeb(regs, MUSB_TESTMODE, 0);
 
-	power = MUSB_POWER_ISOUPDATE;
-	/*
-	 * treating UNKNOWN as unspecified maximum speed, in which case
-	 * we will default to high-speed.
-	 */
+	// power = MUSB_POWER_ISOUPDATE;
+	// /*
+	//  * treating UNKNOWN as unspecified maximum speed, in which case
+	//  * we will default to high-speed.
+	//  */
+
+#ifdef CONFIG_USB_MUSB_SUNXI
+	printk(KERN_INFO "srgn: hs_enabled=%d\n", glue->hs_enabled);
+	if(glue->hs_enabled){
+		if (musb->config->maximum_speed == USB_SPEED_HIGH ||
+				musb->config->maximum_speed == USB_SPEED_UNKNOWN)
+			power |= MUSB_POWER_HSENAB;
+		musb_writeb(regs, MUSB_POWER, power);
+	}
+	else{
+		printk(KERN_INFO "Conclusion: SRGN SUXX!\n");
+		power &= ~MUSB_POWER_HSENAB;
+		musb_writeb(regs, MUSB_POWER, power);
+	}
+#else
+
 	if (musb->config->maximum_speed == USB_SPEED_HIGH ||
 			musb->config->maximum_speed == USB_SPEED_UNKNOWN)
 		power |= MUSB_POWER_HSENAB;
 	musb_writeb(regs, MUSB_POWER, power);
 
+#endif //CONFIG_USB_MUSB_SUNXI
+
 	musb->is_active = 0;
 	devctl = musb_readb(regs, MUSB_DEVCTL);
 	devctl &= ~MUSB_DEVCTL_SESSION;
